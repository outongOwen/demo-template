<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simultaneous Dragging with Constraints</title>
    <style>
      .draggable-item {
        width: 100px;
        height: 100px;
        background-color: lightblue;
        margin: 10px;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="draggable-item1 draggable-item"></div>
      <div class="draggable-item2 draggable-item"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/interactjs@1.10.11"></script>
    <script>
      const draggableItem2 = document.querySelector(".draggable-item2");
      // 获取所有的可拖拽元素
      interact(".draggable-item")
        .draggable({
          // enable inertial throwing
          inertia: true,
          // keep the element within the area of it's parent
          modifiers: [
            interact.modifiers.restrictRect({
              restriction: "parent",
              endOnly: true,
            }),
          ],
          // enable autoScroll
          autoScroll: true,

          listeners: {
            // call this function on every dragmove event
            move: dragMoveListener,

            // call this function on every dragend event
            end(event) {
              var textEl = event.target.querySelector("p");

              textEl &&
                (textEl.textContent =
                  "moved a distance of " +
                  Math.sqrt(
                    (Math.pow(event.pageX - event.x0, 2) +
                      Math.pow(event.pageY - event.y0, 2)) |
                      0,
                  ).toFixed(2) +
                  "px");
            },
          },
        })
        .on("move", function (event) {
          var interaction = event.interaction;

          // if the pointer was moved while being held down
          // and an interaction hasn't started yet
          if (interaction.pointerIsDown && !interaction.interacting()) {
            var original = event.currentTarget,
              // create a clone of the currentTarget element
              clone = event.currentTarget.cloneNode(true);

            // insert the clone to the page
            // TODO: position the clone appropriately
            document.body.appendChild(clone);

            // start a drag interaction targeting the clone
            interaction.start({ name: "drag" }, event.interactable, clone);
          }
        });
    </script>
  </body>
</html>
